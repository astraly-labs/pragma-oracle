use traits::Into;

// Raise a number to a power.
/// * `base` - The number to raise.
/// * `exp` - The exponent.
/// # Returns
/// * `u256` - The result of base raised to the power of exp.
fn pow2(exp: u256) -> u256 {
    if exp == 0.into() {
        return 1.into();
    } else {
        return 2.into() * pow2(exp - 1.into());
    }
}


//function from https://github.com/zkLinkProtocol/zklink-starknet-contracts/blob/497978ec4314ab5d3fd3cd70ea73b70197decbe8/src/utils/math.cairo

fn u256_fast_pow2(exp: u256) -> u256 {
    assert(exp <= 255, 'invalid exp');

    if exp == 0 {
        1
    } else if exp == 1_u256 {
        2_u256
    } else if exp == 2_u256 {
        4_u256
    } else if exp == 3_u256 {
        8_u256
    } else if exp == 4_u256 {
        16_u256
    } else if exp == 5_u256 {
        32_u256
    } else if exp == 6_u256 {
        64_u256
    } else if exp == 7_u256 {
        128_u256
    } else if exp == 8_u256 {
        256_u256
    } else if exp == 9_u256 {
        512_u256
    } else if exp == 10_u256 {
        1024_u256
    } else if exp == 11_u256 {
        2048_u256
    } else if exp == 12_u256 {
        4096_u256
    } else if exp == 13_u256 {
        8192_u256
    } else if exp == 14_u256 {
        16384_u256
    } else if exp == 15_u256 {
        32768_u256
    } else if exp == 16_u256 {
        65536_u256
    } else if exp == 17_u256 {
        131072_u256
    } else if exp == 18_u256 {
        262144_u256
    } else if exp == 19_u256 {
        524288_u256
    } else if exp == 20_u256 {
        1048576_u256
    } else if exp == 21_u256 {
        2097152_u256
    } else if exp == 22_u256 {
        4194304_u256
    } else if exp == 23_u256 {
        8388608_u256
    } else if exp == 24_u256 {
        16777216_u256
    } else if exp == 25_u256 {
        33554432_u256
    } else if exp == 26_u256 {
        67108864_u256
    } else if exp == 27_u256 {
        134217728_u256
    } else if exp == 28_u256 {
        268435456_u256
    } else if exp == 29_u256 {
        536870912_u256
    } else if exp == 30_u256 {
        1073741824_u256
    } else if exp == 31_u256 {
        2147483648_u256
    } else if exp == 32_u256 {
        4294967296_u256
    } else if exp == 33_u256 {
        8589934592_u256
    } else if exp == 34_u256 {
        17179869184_u256
    } else if exp == 35_u256 {
        34359738368_u256
    } else if exp == 36_u256 {
        68719476736_u256
    } else if exp == 37_u256 {
        137438953472_u256
    } else if exp == 38_u256 {
        274877906944_u256
    } else if exp == 39_u256 {
        549755813888_u256
    } else if exp == 40_u256 {
        1099511627776_u256
    } else if exp == 41_u256 {
        2199023255552_u256
    } else if exp == 42_u256 {
        4398046511104_u256
    } else if exp == 43_u256 {
        8796093022208_u256
    } else if exp == 44_u256 {
        17592186044416_u256
    } else if exp == 45_u256 {
        35184372088832_u256
    } else if exp == 46_u256 {
        70368744177664_u256
    } else if exp == 47_u256 {
        140737488355328_u256
    } else if exp == 48_u256 {
        281474976710656_u256
    } else if exp == 49_u256 {
        562949953421312_u256
    } else if exp == 50_u256 {
        1125899906842624_u256
    } else if exp == 51_u256 {
        2251799813685248_u256
    } else if exp == 52_u256 {
        4503599627370496_u256
    } else if exp == 53_u256 {
        9007199254740992_u256
    } else if exp == 54_u256 {
        18014398509481984_u256
    } else if exp == 55_u256 {
        36028797018963968_u256
    } else if exp == 56_u256 {
        72057594037927936_u256
    } else if exp == 57_u256 {
        144115188075855872_u256
    } else if exp == 58_u256 {
        288230376151711744_u256
    } else if exp == 59_u256 {
        576460752303423488_u256
    } else if exp == 60_u256 {
        1152921504606846976_u256
    } else if exp == 61_u256 {
        2305843009213693952_u256
    } else if exp == 62_u256 {
        4611686018427387904_u256
    } else if exp == 63_u256 {
        9223372036854775808_u256
    } else if exp == 64_u256 {
        18446744073709551616_u256
    } else if exp == 65_u256 {
        36893488147419103232_u256
    } else if exp == 66_u256 {
        73786976294838206464_u256
    } else if exp == 67_u256 {
        147573952589676412928_u256
    } else if exp == 68_u256 {
        295147905179352825856_u256
    } else if exp == 69_u256 {
        590295810358705651712_u256
    } else if exp == 70_u256 {
        1180591620717411303424_u256
    } else if exp == 71_u256 {
        2361183241434822606848_u256
    } else if exp == 72_u256 {
        4722366482869645213696_u256
    } else if exp == 73_u256 {
        9444732965739290427392_u256
    } else if exp == 74_u256 {
        18889465931478580854784_u256
    } else if exp == 75_u256 {
        37778931862957161709568_u256
    } else if exp == 76_u256 {
        75557863725914323419136_u256
    } else if exp == 77_u256 {
        151115727451828646838272_u256
    } else if exp == 78_u256 {
        302231454903657293676544_u256
    } else if exp == 79_u256 {
        604462909807314587353088_u256
    } else if exp == 80_u256 {
        1208925819614629174706176_u256
    } else if exp == 81_u256 {
        2417851639229258349412352_u256
    } else if exp == 82_u256 {
        4835703278458516698824704_u256
    } else if exp == 83_u256 {
        9671406556917033397649408_u256
    } else if exp == 84_u256 {
        19342813113834066795298816_u256
    } else if exp == 85_u256 {
        38685626227668133590597632_u256
    } else if exp == 86_u256 {
        77371252455336267181195264_u256
    } else if exp == 87_u256 {
        154742504910672534362390528_u256
    } else if exp == 88_u256 {
        309485009821345068724781056_u256
    } else if exp == 89_u256 {
        618970019642690137449562112_u256
    } else if exp == 90_u256 {
        1237940039285380274899124224_u256
    } else if exp == 91_u256 {
        2475880078570760549798248448_u256
    } else if exp == 92_u256 {
        4951760157141521099596496896_u256
    } else if exp == 93_u256 {
        9903520314283042199192993792_u256
    } else if exp == 94_u256 {
        19807040628566084398385987584_u256
    } else if exp == 95_u256 {
        39614081257132168796771975168_u256
    } else if exp == 96_u256 {
        79228162514264337593543950336_u256
    } else if exp == 97_u256 {
        158456325028528675187087900672_u256
    } else if exp == 98_u256 {
        316912650057057350374175801344_u256
    } else if exp == 99_u256 {
        633825300114114700748351602688_u256
    } else if exp == 100_u256 {
        1267650600228229401496703205376_u256
    } else if exp == 101_u256 {
        2535301200456458802993406410752_u256
    } else if exp == 102_u256 {
        5070602400912917605986812821504_u256
    } else if exp == 103_u256 {
        10141204801825835211973625643008_u256
    } else if exp == 104_u256 {
        20282409603651670423947251286016_u256
    } else if exp == 105_u256 {
        40564819207303340847894502572032_u256
    } else if exp == 106_u256 {
        81129638414606681695789005144064_u256
    } else if exp == 107_u256 {
        162259276829213363391578010288128_u256
    } else if exp == 108_u256 {
        324518553658426726783156020576256_u256
    } else if exp == 109_u256 {
        649037107316853453566312041152512_u256
    } else if exp == 110_u256 {
        1298074214633706907132624082305024_u256
    } else if exp == 111_u256 {
        2596148429267413814265248164610048_u256
    } else if exp == 112_u256 {
        5192296858534827628530496329220096_u256
    } else if exp == 113_u256 {
        10384593717069655257060992658440192_u256
    } else if exp == 114_u256 {
        20769187434139310514121985316880384_u256
    } else if exp == 115_u256 {
        41538374868278621028243970633760768_u256
    } else if exp == 116_u256 {
        83076749736557242056487941267521536_u256
    } else if exp == 117_u256 {
        166153499473114484112975882535043072_u256
    } else if exp == 118_u256 {
        332306998946228968225951765070086144_u256
    } else if exp == 119_u256 {
        664613997892457936451903530140172288_u256
    } else if exp == 120_u256 {
        1329227995784915872903807060280344576_u256
    } else if exp == 121_u256 {
        2658455991569831745807614120560689152_u256
    } else if exp == 122_u256 {
        5316911983139663491615228241121378304_u256
    } else if exp == 123_u256 {
        10633823966279326983230456482242756608_u256
    } else if exp == 124_u256 {
        21267647932558653966460912964485513216_u256
    } else if exp == 125_u256 {
        42535295865117307932921825928971026432_u256
    } else if exp == 126_u256 {
        85070591730234615865843651857942052864_u256
    } else if exp == 127_u256 {
        170141183460469231731687303715884105728_u256
    } else if exp == 128_u256 {
        340282366920938463463374607431768211456_u256
    } else if exp == 129_u256 {
        680564733841876926926749214863536422912_u256
    } else if exp == 130_u256 {
        1361129467683753853853498429727072845824_u256
    } else if exp == 131_u256 {
        2722258935367507707706996859454145691648_u256
    } else if exp == 132_u256 {
        5444517870735015415413993718908291383296_u256
    } else if exp == 133_u256 {
        10889035741470030830827987437816582766592_u256
    } else if exp == 134_u256 {
        21778071482940061661655974875633165533184_u256
    } else if exp == 135_u256 {
        43556142965880123323311949751266331066368_u256
    } else if exp == 136_u256 {
        87112285931760246646623899502532662132736_u256
    } else if exp == 137_u256 {
        174224571863520493293247799005065324265472_u256
    } else if exp == 138_u256 {
        348449143727040986586495598010130648530944_u256
    } else if exp == 139_u256 {
        696898287454081973172991196020261297061888_u256
    } else if exp == 140_u256 {
        1393796574908163946345982392040522594123776_u256
    } else if exp == 141_u256 {
        2787593149816327892691964784081045188247552_u256
    } else if exp == 142_u256 {
        5575186299632655785383929568162090376495104_u256
    } else if exp == 143_u256 {
        11150372599265311570767859136324180752990208_u256
    } else if exp == 144_u256 {
        22300745198530623141535718272648361505980416_u256
    } else if exp == 145_u256 {
        44601490397061246283071436545296723011960832_u256
    } else if exp == 146_u256 {
        89202980794122492566142873090593446023921664_u256
    } else if exp == 147_u256 {
        178405961588244985132285746181186892047843328_u256
    } else if exp == 148_u256 {
        356811923176489970264571492362373784095686656_u256
    } else if exp == 149_u256 {
        713623846352979940529142984724747568191373312_u256
    } else if exp == 150_u256 {
        1427247692705959881058285969449495136382746624_u256
    } else if exp == 151_u256 {
        2854495385411919762116571938898990272765493248_u256
    } else if exp == 152_u256 {
        5708990770823839524233143877797980545530986496_u256
    } else if exp == 153_u256 {
        11417981541647679048466287755595961091061972992_u256
    } else if exp == 154_u256 {
        22835963083295358096932575511191922182123945984_u256
    } else if exp == 155_u256 {
        45671926166590716193865151022383844364247891968_u256
    } else if exp == 156_u256 {
        91343852333181432387730302044767688728495783936_u256
    } else if exp == 157_u256 {
        182687704666362864775460604089535377456991567872_u256
    } else if exp == 158_u256 {
        365375409332725729550921208179070754913983135744_u256
    } else if exp == 159_u256 {
        730750818665451459101842416358141509827966271488_u256
    } else if exp == 160_u256 {
        1461501637330902918203684832716283019655932542976_u256
    } else if exp == 161_u256 {
        2923003274661805836407369665432566039311865085952_u256
    } else if exp == 162_u256 {
        5846006549323611672814739330865132078623730171904_u256
    } else if exp == 163_u256 {
        11692013098647223345629478661730264157247460343808_u256
    } else if exp == 164_u256 {
        23384026197294446691258957323460528314494920687616_u256
    } else if exp == 165_u256 {
        46768052394588893382517914646921056628989841375232_u256
    } else if exp == 166_u256 {
        93536104789177786765035829293842113257979682750464_u256
    } else if exp == 167_u256 {
        187072209578355573530071658587684226515959365500928_u256
    } else if exp == 168_u256 {
        374144419156711147060143317175368453031918731001856_u256
    } else if exp == 169_u256 {
        748288838313422294120286634350736906063837462003712_u256
    } else if exp == 170_u256 {
        1496577676626844588240573268701473812127674924007424_u256
    } else if exp == 171_u256 {
        2993155353253689176481146537402947624255349848014848_u256
    } else if exp == 172_u256 {
        5986310706507378352962293074805895248510699696029696_u256
    } else if exp == 173_u256 {
        11972621413014756705924586149611790497021399392059392_u256
    } else if exp == 174_u256 {
        23945242826029513411849172299223580994042798784118784_u256
    } else if exp == 175_u256 {
        47890485652059026823698344598447161988085597568237568_u256
    } else if exp == 176_u256 {
        95780971304118053647396689196894323976171195136475136_u256
    } else if exp == 177_u256 {
        191561942608236107294793378393788647952342390272950272_u256
    } else if exp == 178_u256 {
        383123885216472214589586756787577295904684780545900544_u256
    } else if exp == 179_u256 {
        766247770432944429179173513575154591809369561091801088_u256
    } else if exp == 180_u256 {
        1532495540865888858358347027150309183618739122183602176_u256
    } else if exp == 181_u256 {
        3064991081731777716716694054300618367237478244367204352_u256
    } else if exp == 182_u256 {
        6129982163463555433433388108601236734474956488734408704_u256
    } else if exp == 183_u256 {
        12259964326927110866866776217202473468949912977468817408_u256
    } else if exp == 184_u256 {
        24519928653854221733733552434404946937899825954937634816_u256
    } else if exp == 185_u256 {
        49039857307708443467467104868809893875799651909875269632_u256
    } else if exp == 186_u256 {
        98079714615416886934934209737619787751599303819750539264_u256
    } else if exp == 187_u256 {
        196159429230833773869868419475239575503198607639501078528_u256
    } else if exp == 188_u256 {
        392318858461667547739736838950479151006397215279002157056_u256
    } else if exp == 189_u256 {
        784637716923335095479473677900958302012794430558004314112_u256
    } else if exp == 190_u256 {
        1569275433846670190958947355801916604025588861116008628224_u256
    } else if exp == 191_u256 {
        3138550867693340381917894711603833208051177722232017256448_u256
    } else if exp == 192_u256 {
        6277101735386680763835789423207666416102355444464034512896_u256
    } else if exp == 193_u256 {
        12554203470773361527671578846415332832204710888928069025792_u256
    } else if exp == 194_u256 {
        25108406941546723055343157692830665664409421777856138051584_u256
    } else if exp == 195_u256 {
        50216813883093446110686315385661331328818843555712276103168_u256
    } else if exp == 196_u256 {
        100433627766186892221372630771322662657637687111424552206336_u256
    } else if exp == 197_u256 {
        200867255532373784442745261542645325315275374222849104412672_u256
    } else if exp == 198_u256 {
        401734511064747568885490523085290650630550748445698208825344_u256
    } else if exp == 199_u256 {
        803469022129495137770981046170581301261101496891396417650688_u256
    } else if exp == 200_u256 {
        1606938044258990275541962092341162602522202993782792835301376_u256
    } else if exp == 201_u256 {
        3213876088517980551083924184682325205044405987565585670602752_u256
    } else if exp == 202_u256 {
        6427752177035961102167848369364650410088811975131171341205504_u256
    } else if exp == 203_u256 {
        12855504354071922204335696738729300820177623950262342682411008_u256
    } else if exp == 204_u256 {
        25711008708143844408671393477458601640355247900524685364822016_u256
    } else if exp == 205_u256 {
        51422017416287688817342786954917203280710495801049370729644032_u256
    } else if exp == 206_u256 {
        102844034832575377634685573909834406561420991602098741459288064_u256
    } else if exp == 207_u256 {
        205688069665150755269371147819668813122841983204197482918576128_u256
    } else if exp == 208_u256 {
        411376139330301510538742295639337626245683966408394965837152256_u256
    } else if exp == 209_u256 {
        822752278660603021077484591278675252491367932816789931674304512_u256
    } else if exp == 210_u256 {
        1645504557321206042154969182557350504982735865633579863348609024_u256
    } else if exp == 211_u256 {
        3291009114642412084309938365114701009965471731267159726697218048_u256
    } else if exp == 212_u256 {
        6582018229284824168619876730229402019930943462534319453394436096_u256
    } else if exp == 213_u256 {
        13164036458569648337239753460458804039861886925068638906788872192_u256
    } else if exp == 214_u256 {
        26328072917139296674479506920917608079723773850137277813577744384_u256
    } else if exp == 215_u256 {
        52656145834278593348959013841835216159447547700274555627155488768_u256
    } else if exp == 216_u256 {
        105312291668557186697918027683670432318895095400549111254310977536_u256
    } else if exp == 217_u256 {
        210624583337114373395836055367340864637790190801098222508621955072_u256
    } else if exp == 218_u256 {
        421249166674228746791672110734681729275580381602196445017243910144_u256
    } else if exp == 219_u256 {
        842498333348457493583344221469363458551160763204392890034487820288_u256
    } else if exp == 220_u256 {
        1684996666696914987166688442938726917102321526408785780068975640576_u256
    } else if exp == 221_u256 {
        3369993333393829974333376885877453834204643052817571560137951281152_u256
    } else if exp == 222_u256 {
        6739986666787659948666753771754907668409286105635143120275902562304_u256
    } else if exp == 223_u256 {
        13479973333575319897333507543509815336818572211270286240551805124608_u256
    } else if exp == 224_u256 {
        26959946667150639794667015087019630673637144422540572481103610249216_u256
    } else if exp == 225_u256 {
        53919893334301279589334030174039261347274288845081144962207220498432_u256
    } else if exp == 226_u256 {
        107839786668602559178668060348078522694548577690162289924414440996864_u256
    } else if exp == 227_u256 {
        215679573337205118357336120696157045389097155380324579848828881993728_u256
    } else if exp == 228_u256 {
        431359146674410236714672241392314090778194310760649159697657763987456_u256
    } else if exp == 229_u256 {
        862718293348820473429344482784628181556388621521298319395315527974912_u256
    } else if exp == 230_u256 {
        1725436586697640946858688965569256363112777243042596638790631055949824_u256
    } else if exp == 231_u256 {
        3450873173395281893717377931138512726225554486085193277581262111899648_u256
    } else if exp == 232_u256 {
        6901746346790563787434755862277025452451108972170386555162524223799296_u256
    } else if exp == 233_u256 {
        13803492693581127574869511724554050904902217944340773110325048447598592_u256
    } else if exp == 234_u256 {
        27606985387162255149739023449108101809804435888681546220650096895197184_u256
    } else if exp == 235_u256 {
        55213970774324510299478046898216203619608871777363092441300193790394368_u256
    } else if exp == 236_u256 {
        110427941548649020598956093796432407239217743554726184882600387580788736_u256
    } else if exp == 237_u256 {
        220855883097298041197912187592864814478435487109452369765200775161577472_u256
    } else if exp == 238_u256 {
        441711766194596082395824375185729628956870974218904739530401550323154944_u256
    } else if exp == 239_u256 {
        883423532389192164791648750371459257913741948437809479060803100646309888_u256
    } else if exp == 240_u256 {
        1766847064778384329583297500742918515827483896875618958121606201292619776_u256
    } else if exp == 241_u256 {
        3533694129556768659166595001485837031654967793751237916243212402585239552_u256
    } else if exp == 242_u256 {
        7067388259113537318333190002971674063309935587502475832486424805170479104_u256
    } else if exp == 243_u256 {
        14134776518227074636666380005943348126619871175004951664972849610340958208_u256
    } else if exp == 244_u256 {
        28269553036454149273332760011886696253239742350009903329945699220681916416_u256
    } else if exp == 245_u256 {
        56539106072908298546665520023773392506479484700019806659891398441363832832_u256
    } else if exp == 246_u256 {
        113078212145816597093331040047546785012958969400039613319782796882727665664_u256
    } else if exp == 247_u256 {
        226156424291633194186662080095093570025917938800079226639565593765455331328_u256
    } else if exp == 248_u256 {
        452312848583266388373324160190187140051835877600158453279131187530910662656_u256
    } else if exp == 249_u256 {
        904625697166532776746648320380374280103671755200316906558262375061821325312_u256
    } else if exp == 250_u256 {
        1809251394333065553493296640760748560207343510400633813116524750123642650624_u256
    } else if exp == 251_u256 {
        3618502788666131106986593281521497120414687020801267626233049500247285301248_u256
    } else if exp == 252_u256 {
        7237005577332262213973186563042994240829374041602535252466099000494570602496_u256
    } else if exp == 253_u256 {
        14474011154664524427946373126085988481658748083205070504932198000989141204992_u256
    } else if exp == 254_u256 {
        28948022309329048855892746252171976963317496166410141009864396001978282409984_u256
    } else {
        57896044618658097711785492504343953926634992332820282019728792003956564819968_u256
    }
}

